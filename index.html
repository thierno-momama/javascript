<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <title>Fetch | API </title>
</head>
<body>
    <div class="container mt-3">
        <h1 class="display-3">Fetch API Sandbox</h1>
        <button id="getText" class="btn btn-primary">Get Text File</button>
        <button id="getJson" class="btn btn-secondary">Get JSON File</button>
        <button id="getApi" class="btn btn-success">Get API External</button>
        <form id="my-form" class="mt-2 form">
            <div class="form-group mt-2">
                <label for="title">Title</label>
                <input type="text" name="title" id="title" class="form-control" required/>
            </div>
            <div class="form-group mt-2">
                <label for="body">Body</label>
                <textarea name="body" id="body" class="form-control" required></textarea>
            </div>
            <input type="submit" class="btn btn-secondary btn-lg mt-1" value="Save">
        </form>
        <hr>
        <div id="response"></div>
    </div>
   
   <script>
       //select
       document.getElementById('getText').addEventListener('click', loadText);
       document.getElementById('getJson').addEventListener('click', loadJson);
       document.getElementById('getApi').addEventListener('click', loadApi);
       document.querySelector('#my-form').addEventListener('submit', loadSubmit);
       //function loadText
       function loadText(){
        //    fetch('sample.txt')
        //    .then(function(res){
        //         return res.text();
        //    }).then(function(data){
        //         return console.log(data);
        //    }) 
        //    .catch(function(err){
        //         console.log(err);
        //    });
            fetch('sample.txt')
            .then((res)=>{
                return res.text();
            }).then((data) => {
                document.querySelector('#response').innerHTML = data;
            }).catch((err)=>{
                console.log(err);
            })
       }
       function loadJson(){
            fetch('users.json')
            .then((res)=>{
                return res.json();
            }).then((data) => {
                let output = '';
                data.forEach((item) => {
                    output += `
                        <ul class='alert alert-secondary'>
                            <li>${item.id}</li>
                            <li>${item.name}</li>
                            <li>${item.email}</li>
                        </ul>
                    `;
                });
                document.querySelector('#response').innerHTML = `<p>${output}</p>`;
            }).catch((err)=>{
                console.log(err);
            })
       }
       function loadApi(){
            fetch('https://jsonplaceholder.typicode.com/posts')
            .then((res)=>{
                return res.json();
            }).then((data) => {
                let output = '';
                data.forEach((item) => {
                    output += `
                        <div class='alert alert-secondary'>
                            <h3>${item.title}</h3>
                            <p>${item.body}</p>
                        </div>
                    `;
                });
                document.querySelector('#response').innerHTML = output;
            }).catch((err)=>{
                console.log(err);
            })
       }
       //function loadSubmit
       function loadSubmit(e){
           e.preventDefault();
           fetch('https://jsonplaceholder.typicode.com/posts', {
            method: 'POST',
            body: JSON.stringify({
                title: document.querySelector('#title').value,
                body: document.querySelector('#body').value,
            }),
            headers: {
                'Content-type': 'application/json; charset=UTF-8',
            },
            })
            .then((response) => response.json())
            .then((json) => {
                console.log(json);
                document.querySelector('#title').value='';
                document.querySelector('#body').value = '';
            });
       }
   </script>
</body>
</html>